# 🧪 魔药酒馆 - Magic Potion Tavern

一个基于Phaser.js的2D魔法酒馆经营游戏，融合了经营模拟、魔药制作、卡牌对战等多种玩法。

## 🎮 游戏特色

### 核心玩法
- **🏪 酒馆经营**: 管理你的魔法酒馆，服务各种奇幻客人
- **🧪 魔药制作**: 通过拖拽材料制作各种神奇魔药
- **⚔️ 卡牌对战**: 与其他魔药师进行策略性卡牌对战
- **📋 随机事件**: 处理各种突发事件和支线任务
- **👥 员工管理**: 雇佣和管理你的酒馆员工

### 独特机制
- **骗子酒馆模式**: 在对战中可以使用虚张声势和识破机制
- **材料合成系统**: 不同的材料组合产生不同的魔药效果
- **声誉系统**: 你的选择会影响酒馆的声誉和发展
- **动态事件**: 随机事件为每次游戏带来不同体验

## 🚀 快速开始

### 环境要求
- 现代浏览器（Chrome、Firefox、Safari等）
- 支持HTML5和ES6+

### 运行游戏
1. 克隆或下载项目代码
2. 在浏览器中打开 `index.html`
3. 等待资源加载完成，开始游戏！

## 📁 项目结构

```
魔药酒馆/
├── index.html              # 游戏主入口
├── js/
│   ├── main.js             # 游戏主文件和初始化
│   ├── scenes/             # 游戏场景
│   │   ├── BootScene.js    # 启动场景
│   │   ├── PreloadScene.js # 资源预加载场景
│   │   ├── MenuScene.js    # 主菜单场景
│   │   ├── TavernScene.js  # 酒馆经营主场景
│   │   ├── BrewingScene.js # 魔药制作场景
│   │   ├── BattleScene.js  # 卡牌对战场景
│   │   └── EventScene.js   # 随机事件场景
│   ├── entities/           # 游戏实体
│   │   ├── Customer.js     # 客人类
│   │   ├── Staff.js        # 员工类
│   │   ├── Potion.js       # 魔药类
│   │   └── Card.js         # 卡牌类
│   ├── managers/           # 游戏管理器
│   │   ├── EventManager.js # 事件管理器
│   │   └── SaveManager.js  # 存档管理器
│   ├── utils/              # 工具类
│   │   ├── GameState.js    # 游戏状态管理
│   │   ├── GameConfig.js   # 游戏配置
│   │   └── CardUtils.js    # 卡牌工具函数
│   ├── data/               # 游戏数据
│   │   ├── PotionRecipes.js # 魔药配方数据
│   │   ├── CardDefinitions.js # 卡牌定义
│   │   └── CustomerTypes.js # 客人类型数据
│   └── ui/                 # UI组件
├── assets/                 # 游戏资源
│   ├── images/            # 图片资源
│   ├── audio/             # 音频资源
│   └── data/              # JSON数据文件
└── README.md              # 项目说明
```

## 🎯 游戏玩法详解

### 酒馆经营 (TavernScene)
- 管理酒馆的日常运营
- 接待不同类型的客人（冒险者、商人、村民等）
- 根据客人需求提供魔药和服务
- 管理员工和库存
- 赚取金币和声誉

### 魔药制作 (BrewingScene)
- 拖拽材料到制作区域
- 根据配方制作各种魔药
- 成功率受技能等级和材料品质影响
- 可解锁新的配方和制作技巧

### 卡牌对战 (BattleScene)
- 与其他魔药师进行回合制卡牌对战
- 使用材料卡和道具卡进行战斗
- **骗子酒馆机制**: 可以虚张声势，也可识破对手
- 双方起始100生命值，策略性出牌

### 随机事件 (EventScene)
- 处理各种突发事件：
  - 贵族的特殊订单
  - 神秘法师的访问
  - 稀有材料的发现
  - 酒馆纠纷
  - 魔法异常现象
  - 竞争对手挑战
  - 节日庆典
- 每个事件都有多个选择，影响不同的结果

## ⚙️ 技术实现

### 游戏引擎
- **Phaser.js 3.70**: 强大的2D游戏引擎
- **现代JavaScript**: ES6+语法，模块化设计

### 核心系统
- **场景管理**: 基于Phaser的场景系统
- **状态管理**: 集中式游戏状态管理
- **事件系统**: 事件驱动的游戏逻辑
- **存档系统**: LocalStorage自动保存

### 特色功能
- **拖拽系统**: 完整的拖拽交互支持
- **粒子效果**: 丰富的视觉特效
- **音效系统**: 背景音乐和音效
- **响应式设计**: 适配不同屏幕尺寸

## 🎨 游戏界面

### 主菜单
- 新游戏/继续游戏选项
- 游戏设置和制作团队
- 精美的背景动画和粒子效果

### 酒馆场景
- 实时客人管理和显示
- 资源面板（金币、声誉、材料）
- 时间系统和营业状态
- 快捷操作按钮

### 魔药制作
- 材料拖拽系统
- 配方匹配提示
- 制作进度和成功率显示
- 视觉特效（蒸汽、粒子、发光）

### 卡牌对战
- 回合制战斗界面
- 手牌管理和出牌系统
- 生命值和回合指示器
- 虚张声势/识破功能

### 事件系统
- 事件详情和选择界面
- 风险指示器
- 奖励预览
- 倒计时机制

## 🔧 开发说明

### 添加新场景
1. 在 `js/scenes/` 创建新的场景文件
2. 继承 `Phaser.Scene` 类
3. 在 `main.js` 中注册场景
4. 实现必要的生命周期方法

### 添加新事件
1. 在 `EventScene.js` 的事件数据库中添加事件定义
2. 设置事件类型、图标、描述和选择项
3. 定义奖励和风险参数

### 添加新魔药
1. 在 `PotionRecipes.js` 中添加配方
2. 定义所需材料和制作参数
3. 更新配方发现逻辑

### 像素素材生成
- 运行 `node generatePixelArtAssets.js` 批量生成/覆盖像素风界面与角色素材
- 所有 SVG 使用竖屏 8x 缩放像素网格，调色板集中于 `generatePixelArtAssets.js`
- 生成结果映射保存在 `assets/placeholder_data.json`，方便快速定位资源类别
- 需要PNG时，搭配 `convert_images.js` 用 `sharp` 将 SVG 转换为位图

## 🎵 音效和音乐

### 背景音乐
- 主菜单主题（`assets/audio/bgm/main-bgm.mp3`）
- 酒馆背景音乐
- 魔药制作音乐
- 对战音乐

### 音效
- 按钮点击和悬停
- 魔药制作成功/失败
- 卡牌出牌和效果
- 事件触发和完成

## 💾 存档系统

### 自动保存
- 定时自动保存游戏进度
- 关键操作后立即保存
- 页面关闭前自动保存

### 存档内容
- 玩家数据和进度
- 酒馆状态和升级
- 库存和配方
- 员工信息
- 游戏统计

## 🐛 错误处理

### 容错机制
- 资源加载失败处理
- 游戏状态异常恢复
- 自动保存错误处理
- 用户操作错误提示

### 调试支持
- 详细的控制台日志
- 错误信息友好显示
- 性能监控和优化

## 🎮 游戏平衡

### 经济系统
- 合理的成本和收益
- 渐进式难度提升
- 风险和回报平衡

### 进度系统
- 等级和经验值
- 声誉和解锁机制
- 成就和奖励系统

## 🚀 未来扩展

### 计划功能
- 更多魔药配方和材料
- 扩展的员工系统
- 多人对战模式
- 更丰富的剧情事件
- 成就系统完善

### 技术优化
- 性能优化和内存管理
- 移动端适配
- 多语言支持
- 音效资源优化

## 📄 许可证

本项目仅供学习和娱乐使用，基于Phaser.js开源引擎开发。

## 🤝 贡献

欢迎提交Issue和Pull Request来改进游戏！

---

**🧪 魔药酒馆 - 成为最强大的魔药大师！**
